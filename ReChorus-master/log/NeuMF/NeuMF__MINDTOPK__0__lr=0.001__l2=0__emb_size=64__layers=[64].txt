INFO:root:Namespace(model_name='NeuMF', model_mode='')
INFO:root:--------------------------------------------- BEGIN: 2024-12-30 00:22:10 ---------------------------------------------
INFO:root:
=================================
 Arguments          | Values     
=================================
 batch_size         | 256       
 data_appendix      |           
 dataset            | MINDTOPK  
 dropout            | 0         
 early_stop         | 10        
 emb_size           | 64        
 epoch              | 200       
 eval_batch_size    | 256       
 gpu                | 0         
 l2                 | 0         
 layers             | [64]      
 lr                 | 0.001     
 main_metric        |           
 num_neg            | 1         
 num_workers        | 5         
 optimizer          | Adam      
 random_seed        | 0         
 save_final_results | 1         
 test_all           | 0         
 topk               | 5,10,20,50
=================================
INFO:root:Device: cpu
INFO:root:Load corpus from data/MINDTOPK/BaseReader.pkl
INFO:root:#params: 35376832
INFO:root:NeuMF(
  (mf_u_embeddings): Embedding(267743, 64)
  (mf_i_embeddings): Embedding(8573, 64)
  (mlp_u_embeddings): Embedding(267743, 64)
  (mlp_i_embeddings): Embedding(8573, 64)
  (mlp): ModuleList(
    (0): Linear(in_features=128, out_features=64, bias=True)
  )
  (dropout_layer): Dropout(p=0, inplace=False)
  (prediction): Linear(in_features=128, out_features=1, bias=False)
)
INFO:root:Test Before Training: (HR@5:0.0493,NDCG@5:0.0308,HR@10:0.0721,NDCG@10:0.0381,HR@20:0.1161,NDCG@20:0.0490,HR@50:0.3643,NDCG@50:0.0966)
INFO:root:Optimizer: Adam
INFO:root:Namespace(model_name='NeuMF', model_mode='')
INFO:root:--------------------------------------------- BEGIN: 2024-12-30 12:31:15 ---------------------------------------------
INFO:root:
=================================
 Arguments          | Values     
=================================
 batch_size         | 256       
 data_appendix      |           
 dataset            | MINDTOPK  
 dropout            | 0         
 early_stop         | 10        
 emb_size           | 64        
 epoch              | 200       
 eval_batch_size    | 256       
 gpu                | 0         
 l2                 | 0         
 layers             | [64]      
 lr                 | 0.001     
 main_metric        |           
 num_neg            | 1         
 num_workers        | 5         
 optimizer          | Adam      
 random_seed        | 0         
 save_final_results | 1         
 test_all           | 0         
 topk               | 5,10,20,50
=================================
INFO:root:Device: cpu
INFO:root:Load corpus from data/MINDTOPK/BaseReader.pkl
INFO:root:#params: 35376832
INFO:root:NeuMF(
  (mf_u_embeddings): Embedding(267743, 64)
  (mf_i_embeddings): Embedding(8573, 64)
  (mlp_u_embeddings): Embedding(267743, 64)
  (mlp_i_embeddings): Embedding(8573, 64)
  (mlp): ModuleList(
    (0): Linear(in_features=128, out_features=64, bias=True)
  )
  (dropout_layer): Dropout(p=0, inplace=False)
  (prediction): Linear(in_features=128, out_features=1, bias=False)
)
INFO:root:Test Before Training: (HR@5:0.0493,NDCG@5:0.0308,HR@10:0.0721,NDCG@10:0.0381,HR@20:0.1161,NDCG@20:0.0490,HR@50:0.3643,NDCG@50:0.0966)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.1838 [198.0 s]	dev=(HR@5:0.1285,NDCG@5:0.0695) [20.0 s] *
INFO:root:Epoch 2     loss=0.1444 [197.9 s]	dev=(HR@5:0.1318,NDCG@5:0.0771) [19.2 s] *
INFO:root:Epoch 3     loss=0.0744 [211.1 s]	dev=(HR@5:0.1232,NDCG@5:0.0737) [21.4 s]
INFO:root:Epoch 4     loss=0.0454 [223.3 s]	dev=(HR@5:0.1222,NDCG@5:0.0734) [21.3 s]
INFO:root:Epoch 5     loss=0.0345 [220.0 s]	dev=(HR@5:0.1273,NDCG@5:0.0775) [21.3 s] *
INFO:root:Epoch 6     loss=0.0293 [223.9 s]	dev=(HR@5:0.1238,NDCG@5:0.0754) [22.5 s]
INFO:root:Epoch 7     loss=0.0260 [224.1 s]	dev=(HR@5:0.1272,NDCG@5:0.0779) [22.0 s] *
INFO:root:Epoch 8     loss=0.0235 [210.6 s]	dev=(HR@5:0.1280,NDCG@5:0.0785) [19.2 s] *
INFO:root:Epoch 9     loss=0.0222 [208.0 s]	dev=(HR@5:0.1301,NDCG@5:0.0799) [19.3 s] *
INFO:root:Epoch 10    loss=0.0202 [208.1 s]	dev=(HR@5:0.1260,NDCG@5:0.0772) [18.9 s]
INFO:root:Epoch 11    loss=0.0192 [210.2 s]	dev=(HR@5:0.1207,NDCG@5:0.0749) [19.4 s]
INFO:root:Epoch 12    loss=0.0182 [211.5 s]	dev=(HR@5:0.1261,NDCG@5:0.0779) [19.8 s]
INFO:root:Epoch 13    loss=0.0174 [211.8 s]	dev=(HR@5:0.1244,NDCG@5:0.0771) [19.8 s]
INFO:root:Epoch 14    loss=0.0165 [211.5 s]	dev=(HR@5:0.1163,NDCG@5:0.0720) [19.3 s]
INFO:root:Epoch 15    loss=0.0159 [211.9 s]	dev=(HR@5:0.1160,NDCG@5:0.0716) [19.3 s]
INFO:root:Epoch 16    loss=0.0155 [212.1 s]	dev=(HR@5:0.1163,NDCG@5:0.0719) [19.3 s]
INFO:root:Epoch 17    loss=0.0148 [211.7 s]	dev=(HR@5:0.1185,NDCG@5:0.0728) [19.4 s]
INFO:root:Epoch 18    loss=0.0146 [211.7 s]	dev=(HR@5:0.1121,NDCG@5:0.0695) [19.8 s]
INFO:root:Early stop at 18 based on dev result.
INFO:root:
Best Iter(dev)=    9	 dev=(HR@5:0.1301,NDCG@5:0.0799) [4179.2 s] 
INFO:root:Load model from ../model/NeuMF/NeuMF__MINDTOPK__0__lr=0.001__l2=0__emb_size=64__layers=[64].pt
INFO:root:
Dev  After Training: (HR@5:0.1301,NDCG@5:0.0799,HR@10:0.2197,NDCG@10:0.1087,HR@20:0.3419,NDCG@20:0.1395,HR@50:0.5717,NDCG@50:0.1846)
INFO:root:
Test After Training: (HR@5:0.0847,NDCG@5:0.0549,HR@10:0.1328,NDCG@10:0.0703,HR@20:0.1960,NDCG@20:0.0862,HR@50:0.3646,NDCG@50:0.1189)
INFO:root:Saving top-100 recommendation results to: ../log/NeuMF/NeuMF__MINDTOPK__0__lr=0/rec-NeuMF-dev.csv
INFO:root:dev Prediction results saved!
INFO:root:Saving top-100 recommendation results to: ../log/NeuMF/NeuMF__MINDTOPK__0__lr=0/rec-NeuMF-test.csv
INFO:root:test Prediction results saved!
INFO:root:
--------------------------------------------- END: 2024-12-30 13:42:50 ---------------------------------------------
